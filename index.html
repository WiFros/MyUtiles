<!DOCTYPE html>
<html>
<head>
    <title>여행 경비 분배기</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .container {
            width: 60%;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            margin-bottom: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        button {
            cursor: pointer;
            padding: 10px 20px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        button:hover {
            background-color: #0056b3;
        }
        #output {
            white-space: pre-line;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>여행 경비 분배기</h1>
        <h2>참여자</h2>
        <table id="participants">
            <tr>
                <th>이름</th>
                <th>동작</th>
            </tr>
            <tr>
                <td><input type="text"></td>
                <td><button onclick="removeRow(this)">삭제</button></td>
            </tr>
        </table>
        <button onclick="addParticipant()">참가자 추가</button>
        <h2>경비 내역</h2>
        <table id="expenses">
            <tr>
                <th>결제자</th>
                <th>결제 금액</th>
                <th>동작</th>
            </tr>
            <tr>
                <td><input type="text"></td>
                <td><input type="text"></td>
                <td><button onclick="removeRow(this)">삭제</button></td>
            </tr>
        </table>
        <button onclick="addExpense()">경비 추가</button>
        <button onclick="calculate()">계산하기</button>
        <pre id="output"></pre>
    </div>
    <script>
        function addParticipant() {
            var row = document.createElement('tr');
            row.innerHTML = '<td><input type="text"></td><td><button onclick="removeRow(this)">삭제</button></td>';
            document.getElementById('participants').appendChild(row);
        }
        
        function addExpense() {
            var row = document.createElement('tr');
            row.innerHTML = '<td><input type="text"></td><td><input type="text"></td><td><button onclick="removeRow(this)">삭제</button></td>';
            document.getElementById('expenses').appendChild(row);
        }

        function removeRow(button) {
            var row = button.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }

        function calculate() {
            var participants = Array.from(document.querySelectorAll('#participants input')).map(input => input.value);
            var expenses = Array.from(document.querySelectorAll('#expenses input')).reduce(function(result, input, index) {
                if (index % 2 == 0) {
                    result.push({name: input.value, expense: 0});
                } else {
                    result[result.length - 1].expense += parseInt(input.value);
                }
                return result;
            }, []);
            
            var total = expenses.reduce((sum, expense) => sum + expense.expense, 0);
            var average = total / participants.length;
            
            var balances = participants.map(function(name) {
                var balance = (expenses.find(expense => expense.name === name) || {expense: 0}).expense - average;
                return {name: name, balance: balance};
            });

            var payers = balances.filter(p => p.balance > 0).sort((a, b) => b.balance - a.balance);
            var payees = balances.filter(p => p.balance < 0).sort((a, b) => a.balance - b.balance);
            
            var transactions = [];

            while (payers.length > 0 && payees.length > 0) {
                var payer = payers[0];
                var payee = payees[0];

                var amount = Math.min(payer.balance, -payee.balance);

                transactions.push({from: payer.name, to: payee.name, amount: amount});

                payer.balance -= amount;
                payee.balance += amount;

                if (payer.balance <= 0) {
                    payers.shift();
                }

                if (payee.balance >= 0) {
                    payees.shift();
                }
            }

            transactions = transactions.map(transaction => {
                return {
                    '수령자': transaction.from,
                    '지불자': transaction.to,
                    '금액': transaction.amount
                };
            });

            var outputText = transactions.map(transaction => {
                return `'${transaction.수령자}' (이)가 '${transaction.지불자}'에게 '${transaction.금액}' 만큼을 받습니다.`;
            }).join('\n');

            document.getElementById('output').textContent = outputText;
        }
    </script>
</body>
</html>
